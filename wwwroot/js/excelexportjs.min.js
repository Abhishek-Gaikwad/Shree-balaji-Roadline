function getColumns(n){var t=[];return $.each(n[0],function(n){var i={};i.headertext=n;i.datatype="string";i.datafield=n;t.push(i)}),t}(function(n){var i={containerid:null,datatype:"table",dataset:null,columns:null,returnUri:!1,locale:"en-US",worksheetName:"My Worksheet",encoding:"utf-8"},t=i;n.fn.excelexportjs=function(r){function h(){var n=t.datatype.toLowerCase();c(n);switch(n){case"table":u=e(l());break;case"json":u=e(o());break;case"xml":u=e(o());break;case"jqgrid":u=e(o())}if(t.returnUri)return u;s()||window.open(u)}function c(i){switch(i){case"json":f=t.dataset;break;case"xml":n(t.dataset).find("row").each(function(){var t={};this.attributes!=null&&this.attributes.length>0&&(n(this.attributes).each(function(){t[this.name]=this.value}),f.push(t))});break;case"jqgrid":n(t.dataset).find("rows > row").each(function(){var t={};this.children!=null&&this.children.length>0&&(n(this.children).each(function(){t[this.tagName]=n(this).text()}),f.push(t))})}}function l(){return n("<div>").append(n("#"+t.containerid).clone()).html()}function o(){var i="<table id='tabledata'>";return i+="<thead><tr>",n(t.columns).each(function(){this.ishidden!=!0&&(i+="<th",this.width!=null&&(i+=" style='width: "+this.width+"'"),i+=">",i+=this.headertext,i+="<\/th>")}),i+="<\/tr><\/thead>",i+="<tbody>",n(f).each(function(r,u){i+="<tr>";n(t.columns).each(function(){u.hasOwnProperty(this.datafield)&&this.ishidden!=!0&&(i+="<td",this.width!=null&&(i+=" style='width: "+this.width+"'"),i+=">",i+=u[this.datafield],i+="<\/td>")});i+="<\/tr>"}),i+="<\/tbody>",i+="<\/table>"}function e(n){var r,u,f;if(s())y(n);else return r="<html xml:lang="+i.locale+" xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:x='urn:schemas-microsoft-com:office:excel' xmlns='http://www.w3.org/TR/REC-html40'>",r+="<head>",r+='<meta http-equiv="Content-type" content="text/html;charset='+i.encoding+'" />',r+="<!--[if gte mso 9]>",r+="<xml>",r+="<x:ExcelWorkbook>",r+="<x:ExcelWorksheets>",r+="<x:ExcelWorksheet>",r+="<x:Name>",r+="{worksheet}",r+="<\/x:Name>",r+="<x:WorksheetOptions>",r+="<x:DisplayGridlines/>",r+="<\/x:WorksheetOptions>",r+="<\/x:ExcelWorksheet>",r+="<\/x:ExcelWorksheets>",r+="<\/x:ExcelWorkbook>",r+="<\/xml>",r+="<![endif]-->",r+="<\/head>",r+="<body>",r+=n.replace(/"/g,"'"),r+="<\/body>",r+="<\/html>",u="data:application/vnd.ms-excel;base64,",f={worksheet:t.worksheetName,table:n},u+a(v(r,f))}function a(n){return window.btoa(unescape(encodeURIComponent(n)))}function v(n,t){return n.replace(/{(\w+)}/g,function(n,i){return t[i]})}function s(){var n=!!navigator.userAgent.match(/Trident/g)||!!navigator.userAgent.match(/MSIE/g);return n>0?!0:!1}function y(n){var f=document.createElement("div"),i,r,u,e,o;for(f.innerHTML=n,i="<table border='2px'><tr bgcolor='#87AFC6'>",r=0,u=t.datatype.toLowerCase()=="table"?document.getElementById(t.containerid):f.children[0],r=0;r<u.rows.length;r++)i=i+u.rows[r].innerHTML+"<\/tr>";return i=i+"<\/table>",i=i.replace(/<A[^>]*>|<\/A>/g,""),i=i.replace(/<img[^>]*>/gi,""),i=i.replace(/<input[^>]*>|<\/input>/gi,""),e=window.navigator.userAgent,o=e.indexOf("MSIE "),o>0||!!navigator.userAgent.match(/Trident.*rv\:11\./)?(txtArea1.document.open("txt/html","replace"),txtArea1.document.write(i),txtArea1.document.close(),txtArea1.focus(),sa=txtArea1.document.execCommand("SaveAs",!0,"download")):sa=window.open("data:application/vnd.ms-excel,"+encodeURIComponent(i)),sa}t=n.extend({},i,r);var f=[],u;return h()}})(jQuery);