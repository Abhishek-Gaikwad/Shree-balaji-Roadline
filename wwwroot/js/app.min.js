$(function(){$(".table").DataTable()});const showInPopup=(n,t,i=false)=>{$.ajax({type:"GET",url:n,beforeSend:function(){$("#loader").removeClass("display-none")},success:function(r){$("#form-model .modal-body").html(r);$("#form-model .modal-title").html(t);$("#form-model").modal({show:!0,keyboard:!1,backdrop:"static"});(n.indexOf("Driver")>-1||n.indexOf("Marching")>-1)&&showImagePreview();i&&(table=$("#table-billing").DataTable({columnDefs:[{targets:0,checkboxes:{selectRow:!0}}]}));switch(t.toLowerCase().replace("new ","").replace("update ","")){case"shipment":$(".selectpicker").selectpicker();$(".dropdown-toggle").addClass(" btn-sm");break;case"roles":$(".selectpicker").selectpicker();$(".dropdown-toggle").addClass(" btn-sm");break;case"irn & received amount":$(".selectpicker").selectpicker();$(".dropdown-toggle").addClass(" btn-sm");break;case"marching":$(".selectpicker").selectpicker();$(".dropdown-toggle").addClass(" btn-sm");calculateExpense()}let u=$("#error").val();typeof u!="undefined"&&u.length>0&&warning(u)},complete:function(){$("#loader").addClass("display-none")},error:function(){$("#loader").addClass("display-none")}})},showNestedPopup=(n,t)=>{$.ajax({type:"GET",url:n,beforeSend:function(){$("#pploader").removeClass("display-none")},success:function(n){$("#extra-model .modal-body").html(n);$("#extra-model .modal-title").html(t);$("#extra-model").modal({show:!0,keyboard:!1,backdrop:"static"})},complete:function(){$("#pploader").addClass("display-none")},error:function(){$("#pploader").addClass("display-none")}})},jQueryAjaxPost=n=>{try{confirm("Do You Want To Complete Your Task.. ?")&&$.ajax({type:"POST",url:n.action,data:new FormData(n),contentType:!1,processData:!1,beforeSend:function(){$("#pploader").removeClass("display-none")},success:function(n){if(n.isValid)success(),$("#view-all-transaction").html(n.html),$("#form-model .modal-body").html(""),$("#form-model .modal-title").html(""),$("#form-model").modal("hide"),$(".table").DataTable();else{let t=n.message!==null?n.message:"Something Went Wrong...!";error(t);$("#form-model .modal-body").html(n.html);switch(n.source.replace("new ","").replace("update ","")){case"shipment":$(".selectpicker").selectpicker();$(".bs-placeholder").addClass(" btn-sm");break;case"roles":$(".selectpicker").selectpicker();$(".bs-placeholder").addClass(" btn-sm");break;case"marching":$(".selectpicker").selectpicker();$(".bs-placeholder").addClass(" btn-sm")}}},complete:function(){$("#pploader").addClass("display-none")},error:function(){$("#pploader").addClass("display-none")}})}catch(t){error();console.log(t)}return!1},jQueryIncidencePost=n=>{try{confirm("Do You Want To Complete Your Task.. ?")&&$.ajax({type:"POST",url:n.action,data:new FormData(n),contentType:!1,processData:!1,beforeSend:function(){$("#pploader").removeClass("display-none")},success:function(n){if(n.isValid){var t="";n.message.includes("Billing/export")&&(t=n.message.substring(n.message.lastIndexOf("/")+1),t="Your Transaction Completed successfully...\r\n Reference No. #"+t);success(t);$("#view-all-transaction").html(n.html);$("#form-model .modal-body").html("");$("#form-model .modal-title").html("");$("#form-model").modal("hide");window.open(n.message,"_blank");$(".table").DataTable()}else{let t=n.message!==null?n.message:"Something Went Wrong...!";error(t);$("#form-model .modal-body").html(n.html)}},complete:function(){$("#pploader").addClass("display-none")},error:function(){$("#pploader").addClass("display-none")}})}catch(t){error();console.log(t)}return!1},jQueryBulkPost=n=>{try{confirm("Do You Want To Complete Your Task.. ?")&&$.ajax({type:"POST",url:n.action,data:new FormData(n),contentType:!1,processData:!1,beforeSend:function(){$("#pploader").removeClass("display-none")},success:function(n){if(n.isValid)success(),console.log(n),console.log(n.data),$("#view-all-transaction").html(n.html),$("#form-model .modal-body").html(""),$("#form-model .modal-title").html(""),$("#form-model").modal("hide"),$(".table").DataTable(),n.data!==null&&$("#dvjson").excelexportjs({containerid:"dvjson",datatype:"json",dataset:n.data,columns:getColumns(n.data)});else{let t=n.message!==null?n.message:"Something Went Wrong...!";error(t);$("#form-model .modal-body").html(n.html)}},complete:function(){$("#pploader").addClass("display-none")},error:function(){$("#pploader").addClass("display-none")}})}catch(t){error()}return!1},jQueryDataPost=n=>{var i=n.action,t=parseInt($("#referenceNo").val());return t>0&&window.open(i+"/"+t,"_blank"),!1},jQueryAjaxDelete=n=>{try{swal({title:"Are you sure?",text:"Once deleted, you will not be able to recover it again!",icon:"warning",buttons:!0,dangerMode:!0}).then(t=>{t&&$.ajax({type:"POST",url:n.action,data:new FormData(n),contentType:!1,processData:!1,beforeSend:function(){$("#pploader").removeClass("display-none")},success:function(n){if(n.isValid)success(),$("#view-all-transaction").html(n.html),$("#form-model .modal-body").html(""),$("#form-model .modal-title").html(""),$("#form-model").modal("hide"),$(".table").DataTable();else{let t=n.message!==null?n.message:"Something Went Wrong...!";error(t);$("#form-model .modal-body").html(n.html)}},complete:function(){$("#pploader").addClass("display-none")},error:function(){$("#pploader").addClass("display-none")}})})}catch(t){error();cosole.log(t)}return!1},getDriverDetails=n=>{let t=n.value;if(t>0)try{$.ajax({type:"POST",url:"/Driver/getdriver/"+t,contentType:!1,processData:!1,beforeSend:function(){$("#pploader").removeClass("display-none")},success:function(n){if(console.log(n),n.isValid){var t=n.result;t!==null&&($("#driverId").val(t.driverId),$("#aadharNo").val(t.aadharNo),$("#dlNo").val(t.dlNo),$("#driverName").val(t.driverName),$("#mobileNo").val(t.mobileNo),$.each(t.aadharDocs,function(n,t){showImagePreview(n,"aadharcard",t)}),$.each(t.licenseDocs,function(n,t){showImagePreview(n,"licensecard",t)}),$.each(t.photos,function(n,t){showImagePreview(n,"photo",t)}),$.each(t.bankDocs,function(n,t){showImagePreview(n,"bankdetail",t)}))}else warning(n.message)},complete:function(){$("#pploader").addClass("display-none")},error:function(){$("#pploader").addClass("display-none")}})}catch(i){cosole.log(i)}return!1},getDealerDetails=n=>{let t=n.value;if(t!==null|t!=="")try{$.ajax({type:"POST",url:"/Dealer/getdealer/"+t,contentType:!1,processData:!1,beforeSend:function(){$("#pploader").removeClass("display-none")},success:function(n){if(console.log(n),n.isValid){var t=n.result;t!==null&&$("#location").val(t.city)}else warning(n.result)},complete:function(){$("#pploader").addClass("display-none")},error:function(){$("#pploader").addClass("display-none")}})}catch(i){cosole.log(i)}return!1},getDestinationDetails=n=>{let t=n.value;if(t!==null|t!=="")try{$.ajax({type:"POST",url:"/Destination/getdestination/"+t,contentType:!1,processData:!1,beforeSend:function(){$("#pploader").removeClass("display-none")},success:function(n){if(console.log(n),n.isValid){var t=n.result;if(t!==null){$("#region").val(t.region);$("#trasitDays").val(t.trasitDays);$("#routeCode").val(t.routeCode);let n=$("#mfgCode").val()+t.routeCode;$("#mfgRoute").val(n);getFreightDetails()}}else warning(n.result)},complete:function(){$("#pploader").addClass("display-none")},error:function(){$("#pploader").addClass("display-none")}})}catch(i){cosole.log(i)}return!1},getVcDetails=n=>{let t=n.value;if(t!==null|t!=="")try{$.ajax({type:"POST",url:"/VcMaster/getvc/"+t,contentType:!1,processData:!1,beforeSend:function(){$("#pploader").removeClass("display-none")},success:function(n){if(console.log(n),n.isValid){var t=n.result;if(t!==null){$("#modelDesc").val(t.modelDesc);$("#mfgCode").val(t.mfgCode);$("#plantDesc").val(t.plantDesc);$("#plantCode").val(t.plantCode);let n=t.mfgCode+$("#routeCode").val();$("#mfgRoute").val(n);getFreightDetails()}}else warning(n.result)},complete:function(){$("#pploader").addClass("display-none")},error:function(){$("#pploader").addClass("display-none")}})}catch(i){cosole.log(i)}return!1},getPaymentDetails=n=>{let t=n.value;if(t!==null|t!=="")try{$.ajax({type:"POST",url:"/Payment/getvoucher/"+t,contentType:!1,processData:!1,beforeSend:function(){$("#pploader").removeClass("display-none")},success:function(n){if(console.log(n),n.isValid){var t=n.result;t!==null&&($("#shipmentId").val(t.shipmentId),$("#receiptNo").val(t.serialNo),$("#totalAmount").val(t.totalExp),$("#paibAmount").val(t.paidAmount),$("#balanceAmount").val(t.balance),$("#view-vouchers").html(t.vcList))}else warning(n.result)},complete:function(){$("#pploader").addClass("display-none")},error:function(){$("#pploader").addClass("display-none")}})}catch(i){cosole.log(i)}return!1},getPumpDetails=n=>{let t=n.value;if(t!==null|t!=="")try{$.ajax({type:"POST",url:"/PumpMaster/getpump/"+t,contentType:!1,processData:!1,beforeSend:function(){$("#pploader").removeClass("display-none")},success:function(n){if(console.log(n),n.isValid){var t=n.result;t!==null&&$("#spdRate").val(t.rate)}else warning(n.result)},complete:function(){$("#pploader").addClass("display-none")},error:function(){$("#pploader").addClass("display-none")}})}catch(i){cosole.log(i)}return!1},getFreightDetails=()=>{let n=$("#mfgCode").val(),t=$("#routeCode").val(),i=n+t;if(n!==null|n!==""&&t!==null|t!=="")try{$.ajax({type:"POST",url:"/MfgRoute/getfreight/"+i,contentType:!1,processData:!1,beforeSend:function(){$("#pploader").removeClass("display-none")},success:function(n){if(console.log(n),n.isValid){var t=n.result;t!==null&&($("#basicFreight").val(t.basicFreight),$("#enRoute").val(t.enRoute),$("#totalFreight").val(t.totalFreight))}else warning(n.result)},complete:function(){$("#pploader").addClass("display-none")},error:function(){$("#pploader").addClass("display-none")}})}catch(r){cosole.log(r)}return!1},showPreview=n=>{var i=n.files,t,r;if(filesLength=i.length,filesLength>0)for(t=0;t<filesLength;t++)r=i[t],imgData=readImageData(t,r,n.id);return!1},readImageData=(n,t,i)=>{const r=new FileReader;r.addEventListener("load",()=>{showImagePreview(n,i,r.result)},!1);t&&r.readAsDataURL(t)},showImagePreview=(n,t,i)=>{if(typeof t!="undefined"){var r=$("#"+t+"-preview").html(),u=(r.match(/href/g)||[]).length;n=r.length==0?1:n+u+1;r+='<a class="image-link" data-lightbox="'+t+'" data-title="'+t+" "+n+'" href="'+i+'">';n===1&&(r+='<i class="fa fa-eye"><\/i><\/a>');r+="<\/a>";$("#"+t+"-preview").html(r)}},checkRemark=n=>{let t=n.value;return $("#reason-block").css("display","none"),t.toLowerCase()==="others"&&$("#reason-block").css("display","block"),t!=null&t!=""?($("#status").val(t),$("#status").data("status").value(t)):(t=$("#status").data("status"),$("#status").val(t)),!1},calculateHsd=()=>{let u=$("#totalHsd").val(),t=$("#spdQty").val(),n=$("#spdRate").val();n=parseFloat(n);let f=t*n;$("#spdAmount").val(f.toFixed(2));let i=parseFloat(u)-parseFloat(t),r=$("#remainhsd-prefix").data("rate");$("#remainhsd-prefix").html(""+i.toFixed(2)+" * "+r);let e=i.toFixed(2)*parseFloat(r);return $("#remainhsd").val(e.toFixed(2)),calculateTotalExpense(),!1},calculateExpense=()=>{let n=$("#inRouteExp").val(),t=$("#tollExp").val();return totalexp=parseFloat(n)-parseFloat(t),$("#total-inroot").val(totalexp.toFixed(2)),calculateTotalExpense(),!1},calculateFreight=()=>{let n=parseFloat($("#basicFreight").val()),t=parseFloat($("#enRoute").val());return totalFreight=(isNaN(n)?0:n)+(isNaN(t)?0:t),$("#totalFreight").val(totalFreight.toFixed(2)),!1},calculateTotalExpense=()=>{let n=$("#total-inroot").val(),t=$("#remainhsd").val(),i=$("#driverPayment").val(),r=$("#loadingCharge").val(),u=$("#extraAmt").val(),f=parseFloat(n)+parseFloat(t)+parseFloat(i)-parseFloat(r)+parseFloat(u);return $("#totalExp").val(f.toFixed(2)),!1},calculateBilling=()=>{let n=[],t=table.column(0).checkboxes.selected();$.each(t,(t,i)=>{n.push(i)});try{$("#shipmentNos").val(n.toString());$("#billing-form").submit()}catch(i){console.log(i)}return!1},getShipmentNos=n=>{let t=[];return $.each(n,(n,i)=>{t.push(i)}),t},calculatePayAmount=n=>{let i=n.value,t=0;if(i.length>0){let u=$("#totalAmount").val(),r=$("#balanceAmount").val();t=n.id!="amount"?parseFloat(u)*parseFloat(i/100):$("#amount").val();parseFloat(r)>=parseFloat(t)?$("#amount").val(t):(alert("payment amount less than balance"),$("#amount").val(r))}},updateInvoiceDate=n=>{let t=n.value;return $("#invoiceDate").val(t),!1},checkIsNewDriver=n=>($("#driverName").css("display","none"),$("#driverId").css("display","inline"),$(".dropdown").css("display","block"),$("#lbl-diver").text("Driver"),n.checked==!0&&($("#driverName").css("display","inline"),$("#driverId").css("display","none"),$(".dropdown").css("display","none"),$("#lbl-diver").text("Driver Name")),!1),hideStatue=n=>{if(n.id==="ewayNo"){let t=n.value;t.replace(" ","");t.length>0?($("#status-block").css("display","none"),$("#reason-block").css("display","none")):($("#status-block").css("display","block"),$("#reason-block").css("display","none"),status.toLowerCase()==="others"&&$("#reason-block").css("display","block"))}else if(n.id==="epodNo"){const[t]=n.files;t?($("#status-block").css("display","none"),$("#reason-block").css("display","none")):($("#status-block").css("display","block"),$("#reason-block").css("display","none"),status.toLowerCase()==="others"&&$("#reason-block").css("display","block"))}return!1},success=n=>(n=typeof n=="undefined"||n===null?"Your Transaction Completed successfully..":n,swal("Good job!",n,"success"),!1),warning=n=>(swal("Ohh!",n,"warning"),!1),info=n=>(swal("Ohh!",n,"info"),!1),error=n=>(n=n===null?"Your Transaction has been failed..":n,swal("Oh noes!",n,"error"),!1),confirmDelete=()=>{swal({title:"Are you sure?",text:"Once deleted, you will not be able to recover it again!",icon:"warning",buttons:!0,dangerMode:!0}).then(n=>n)};